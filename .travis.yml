dist: trusty
env:
  global:
    secure: mbgczNahxdufLTx+InP2n8I8zoUsn1jCZURoo64vEaKdbia2mCVco6UHWzQ5vYHXtxEeKOapLPal/UdkC+p+GWqcX4Xqq4efzHRdmjD9aGA5MUP+gvt+ryrQJDk4ef6gQ8F10Hx7oJTxFAWqF9EKCGmBV+CM2/Aesue/wC7rBkl/TC+tTg2MUNv3+xTNcJ6M/wuPRGTywQBfVo/MqalSHq8zY8C8DsAbucSOjE9MM8RmGnpdJqmgIwsxs3x8KV6/1Exdm/VE9OmGBPpp8Ffa+slLXk9NQKMDp/2dyoJz6H3Q/+J5XGPCV2haRwZ/ROYEBaRyihpKZx/w1IBHqFJzdI8MCUGQlKUjp2yizEIRf5bKywLLxjkKjAOboD2cB9O3KnHAWdyIz267zp0hzFUVyMsP15XomOdrOANYGFIaUSOZ1We6MdaPdrA81Kp0JCnA+6h5usVD5d/UNyeaZxpjykzWTusIvp6KD1q5I3sLOQKy4k0CoYZrtYJ8gHWZ7dRdM92pWdvOfC8yTLbEweMqRycbx/XZIF5Xt0QMf5jPvozbQZjaRzabgwrvQOrQiyL2AyMnrHn45svrMasZw5901h2KcgZtrw6WnPnOT0QUlgk8i6N/qtS7HIEGyBLn6WKp/f1nqqXsTLe7Yor4iGqPAhfIqwNNZda7Aj5V1IHUKDQ=
jobs:
  include:
  - stage: build docker image
    script:
    - echo $DOCKER_USERNAME
    - echo "$DOCKER_PASSWORD" | docker login -u $DOCKER_USERNAME --password-stdin
    - docker build . --build-arg BASE_IMAGE=ubuntu --build-arg BASE_IMAGE_TAG='16.04'
      -t "liambindle/penelope:$(date '+%g.%m')-ubuntu"
    - docker push "liambindle/penelope:$(date '+%g.%m')-ubuntu"
  - stage: test
  - script: docker run --rm "liambindle/penelope:$(date '+%g.%m')-ubuntu" cat hello.txt
