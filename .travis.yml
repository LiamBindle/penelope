dist: trusty
env:
  - secure: NKp+024LarZEwhc+7r5my6sq16H+mC3m04bxr1NxkdMCAS8WxkYj4asrW3o9DAfvendh5LUf4a043r/uES+pX6639NbcdzTuHpqz34uyERHiczlMB9SwZWIMqKSSGPEzvK3MZFHPLZ8ZRhNK5lPyCNT339niqGNS2vFG4vIPk5ZFFkeyAj8vYA86LyXVc2ShDuPgOOwjbVfUvXJlneX+WNJs4xQ8P4wQwDn+BZIFJ94dvL0x4SCsYhTBldBNM08mI1Z2Jd3wQZ5wSupmkkwiD+tnGYIGF+MeNTe9N46EiXLqdXYlJx45o9sJRlWNHQ1rg5ZMNMRyLAkgqNPSIJGTO7tJG6skPfwFFjR+QPFZlytZW8COXJ+9a2hpkwY8SLOkrj+ajxf6CuyLMJDhs8sb0V7L9ocz2AgfYNzWWY0CCGhFEHW8pXKbVkOFFK44z2jzEPh+aZkLPoS8UdjpFPGfnsHnCBrEoXupL2pFCzJB2yo+wf3vnI/cyyejMXYIiN+ZW5GUSN7JyBaKilejwIT9gmVReJXE3LhQGnC68pJZtCdUQvv9h1BYP6nkMyEGRJiiJfM/Q4Bwd8Y47qwuC1MylQvxRQdyXaklahZ/ARYKc948tHUI1qEuL12l2iH++5zMcMVjb7OwkQAAg3UDVLLfpzsILpA5dbQ2Bd80GrbTaus=
jobs:
  include:
  - stage: build docker image
    script:
    - echo $DOCKER_USERNAME
    - echo "$DOCKER_PASSWORD" | docker login -u $DOCKER_USERNAME --password-stdin
    - docker build . --build-arg BASE_IMAGE=ubuntu --build-arg BASE_IMAGE_TAG='16.04'
      -t "liambindle/penelope:$(date '+%g.%m')-ubuntu"
    - docker push "liambindle/penelope:$(date '+%g.%m')-ubuntu"
  - stage: test
  - script: docker run --rm "liambindle/penelope:$(date '+%g.%m')-ubuntu" cat hello.txt
