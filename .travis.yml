dist: trusty
env:
  global:
    - secure: vD7tbxmC9BISHHdRlsafrOKn4g0BTNLb4rj8zmfaRyN9hUzEYgxgMqAMVj0d/4WA/V6HLZKtE1EkmSWFv7ZidfXrTpK9HKbBuU1jYNdSUqS7fK7KASFTZ6fW1uMLgRRU5V7ocCQ6XSYuIDXpjGPaCOAz8W8eYjFYAa3p2sjuVNqVqfYifPPoHHCJ2syTfehVXfgk883tdUUlwLzl2jHK+rfLoF4i8Xdm0IVZHA4Bz7u8Q3RxlabUwBjDipjG66zQ/iuECpQEQrJy71v1jh1inrfOBaSZI6Nzx1hMX8KxspoUkcJqnjGf0h8KDuO+m9piU0aa32pOTR//roqjazsf07gc+dc79Pe9RDXywZlw2JH8RhOgAVDnKQCOeNvnr8yWphUeP5H0B6ViPrfn7GkYabs3QoS8REITtTnyIeX7YCthfEUhulQqMx+JaRaXpOXg/lB/WgbZDMH5MTXwn5MpWo9jNz7wkBPhtVNXEipFuWqxa5UpEOzY2rfaEyJ5amsQx0U0Wp1dP5+GS7kC5sppGgZRUM1krCsSPQFcQ3jJ3MUDS+af//Mqq++JkTEkY9GZV23bw7lDh5yvhSD+G50uuRpMgGkO/VY+O5vOSNnrc5FnRWELo2A2oEGfAFgVUrv+xmPvLooU5yPQor519H4O0S236042INVcJcFeLK8Vwn8=
jobs:
  include:
  - stage: build docker image
    script:
    - echo $DOCKER_USERNAME
    - echo "$DOCKER_PASSWORD" | docker login -u $DOCKER_USERNAME --password-stdin
    - docker build . --build-arg BASE_IMAGE=ubuntu --build-arg BASE_IMAGE_TAG='16.04'
      -t "liambindle/penelope:$(date '+%g.%m')-ubuntu"
    - docker push "liambindle/penelope:$(date '+%g.%m')-ubuntu"
  - stage: test
  - script: docker run --rm "liambindle/penelope:$(date '+%g.%m')-ubuntu" cat hello.txt
