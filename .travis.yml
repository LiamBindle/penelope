dist: trusty
env:
  global:
    secure: jGoRu/3rwfbZTqbpUhl2uq4emBmIKFUqs5+MRu6//zNFvES+U23FjF0tz+0NVyuvQ268+Zz5xXzVkBdJUIM8aIPi48sFytH0Y0S/DFrnCxAYwA5CzMOKfFRo6BhG0r9GidRGaUEfXaAkqLBfKoZoBzYSUItTfaTgrHw5F9b4Owt3STJXnVjRwhy8pYph3ldPvNgjoSqYf40+5bamEL3hEjH8yDPM5kDaDndaNfDoPW8fSShz0oowGqdyYCdS4S1+yfuWdbthgiPOmN9j5DqTdmBNXcq1JW1U3NFyPqAda+MPUzcoHs5APIK+pXPWuufC5QFLeUWd1vExvDXBJUf0l1E9vVpgMxzGsSZhBIlJk3OvczkJnWlu9xhypGyQ4ReDnRlnwuBb3hnb5TIS40txMqrsrQ1lE2qvKl9zxz8D9AvbxvOCLhTNPR5oueMQhV+/aMZPytYfYYE6NE2st65kNwDNhlLqlqIv56P1sDbP1hNw7nzhkkmqciqUxBipWM9CfEEZakMF0zDLgJF1Y4sFCiuyk5lLdwNzrj2MlkBD8Y/Hrpu1I7tunPcjb0+pnjWlVk1yihoLEzEWfBTtzeogqAeLcUIsimU8oSAd9pwSxOoHriom5CqD/fv/qjzh2SU/VEHs6J1cOEf/q/rFSpDtB/nwiC1DtwfJq1Jh366oR84=
jobs:
  include:
  - stage: build docker image
    script:
    - echo $DOCKER_USERNAME
    - echo "$DOCKER_PASSWORD" | docker login -u $DOCKER_USERNAME --password-stdin
    - docker build . --build-arg BASE_IMAGE=ubuntu --build-arg BASE_IMAGE_TAG='16.04'
      -t "liambindle/penelope:$(date '+%g.%m')-ubuntu"
    - docker push "liambindle/penelope:$(date '+%g.%m')-ubuntu"
  - stage: test
  - script: docker run --rm "liambindle/penelope:$(date '+%g.%m')-ubuntu" cat hello.txt
